/**
 * Manual completion confirmation options.
 *
 * @module   mod_pulse/confirmcompletion
 * @copyright 2023, bdecent gmbh bdecent.de
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_pulse/confirmcompletion",["jquery","core/str","core/modal_factory","core/notification","core/ajax","core/fragment","core/modal_events"],(function($,Str,ModalFactory,notification,Ajax,Fragment,ModalEvents){const getModal=function(id,contextid){var args={id:id};ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:Str.get_string("confirmation","pulse"),body:"",large:!1}).then((function(modal){return modal.show(),Fragment.loadFragment("mod_pulse","get_confirmation_content",contextid,args).done(((html,js)=>(modal.setBody(html),html))).catch(notification.exception),modal.setButtonText("save",Str.get_string("yes")),modal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault(),submitformdata(args),modal.getRoot().find("form").submit(),modal.hide()})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal})).catch(notification.exception)},submitformdata=function(params){Ajax.call([{methodname:"mod_pulse_manual_completion",args:params,done:function(response){window.location.reload(),response.message&&notification.addNotification({message:response.message,type:"success"})}}])};return{init:function(contextid){!function(contextid){document.body.classList.contains("path-course-view")&&document.querySelectorAll(".pulse-user-manualcompletion-btn").forEach((function(element){element.addEventListener("click",(function(e){var id=e.target.className.match(/confirmation-(\d+)/);id&&(id=id[1],getModal(id,contextid))}))}))}(contextid)}}}));

//# sourceMappingURL=confirmcompletion.min.js.map